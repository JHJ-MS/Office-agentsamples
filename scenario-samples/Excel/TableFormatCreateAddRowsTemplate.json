{
  "Templates": [
    {
      "Description": "Add rows, columns to a table. Format a table.",
      "SampleCodes": "async function createTable() {\n  await Excel.run(async (context) => {\n    context.workbook.worksheets.getItemOrNullObject(\"Sample\").delete();\n    const sheet = context.workbook.worksheets.add(\"Sample\");\n\n    const expensesTable = sheet.tables.add(\"A1:D1\", true /*hasHeaders*/);\n    expensesTable.name = \"ExpensesTable\";\n\n    expensesTable.getHeaderRowRange().values = [[\"Date\", \"Merchant\", \"Category\", \"Amount\"]];\n\n	// The columns here should strictly align with the columns of the table.\n    expensesTable.rows.add(null /*add at the end*/, [\n      [\"1/1/2017\", \"The Phone Company\", \"Communications\", \"$120\"],\n      [\"1/2/2017\", \"Northwind Electric Cars\", \"Transportation\", \"$142\"],\n      [\"1/5/2017\", \"Best For You Organics Company\", \"Groceries\", \"$27\"]\n    ]);\n\n    sheet.getUsedRange().format.autofitColumns();\n    sheet.getUsedRange().format.autofitRows();\n\n    sheet.activate();\n\n    await context.sync();\n  });\n}\n\nasync function formatTable() {\n  await Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.getItem(\"Sample\");\n    const firstTable = sheet.tables.getItemAt(0);\n\n    // set the table header's color\n    firstTable.getHeaderRowRange().format.fill.color = \"#C70039\";\n    // set the table body's color\n    firstTable.getDataBodyRange().format.fill.color = \"#DAF7A6\";\n    // set the second table row's color\n    firstTable.rows.getItemAt(1).getRange().format.fill.color = \"#FFC300\";\n    // set the first table column's color\n    firstTable.columns.getItemAt(0).getDataBodyRange().format.fill.color = \"#FFA07A\";\n\n    await context.sync();\n  });\n}\n\nasync function addRowToTable() {\n  await Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.getItem(\"Sample\");\n    const expensesTable = sheet.tables.getItem(\"ExpensesTable\");\n\n    // The array columns' count should strictly align with the table columns' count.\n    expensesTable.rows.add(null, [\n      [\"1/16/2017\", \"THE PHONE COMPANY\", \"Communications\", \"$120\"],\n      [\"1/20/2017\", \"NORTHWIND ELECTRIC CARS\", \"Transportation\", \"$142\"],\n      [\"1/20/2017\", \"BEST FOR YOU ORGANICS COMPANY\", \"Groceries\", \"$27\"]\n    ]);\n\n    sheet.getUsedRange().format.autofitColumns();\n    sheet.getUsedRange().format.autofitRows();\n\n    await context.sync();\n  });\n}\n\nasync function addColumnToTable() {\n  await Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.getItem(\"Sample\");\n    const expensesTable = sheet.tables.getItem(\"ExpensesTable\");\n\n    // The array rows' count should strictly align with the table rows' count.\n    expensesTable.columns.add(null, [\n      [\"Deductable?\"],\n      [\"Yes\"],\n      [\"Yes\"],\n      [\"No\"],\n      [\"No\"],\n      [\"Yes\"],\n      [\"Yes\"],\n      [\"No\"],\n      [\"Yes\"],\n      [\"Yes\"],\n      [\"No\"]\n    ]);\n\n    sheet.getUsedRange().format.autofitColumns();\n    sheet.getUsedRange().format.autofitRows();\n\n    await context.sync();\n  });\n}\n\n/** Create a new table with sample data */\nasync function setup() {\n  await Excel.run(async (context) => {\n    context.workbook.worksheets.getItemOrNullObject(\"Sample\").delete();\n    const sheet = context.workbook.worksheets.add(\"Sample\");\n\n    const expensesTable = sheet.tables.add(\"A1:D1\", true /*hasHeaders*/);\n    expensesTable.name = \"ExpensesTable\";\n    expensesTable.getHeaderRowRange().values = [[\"Date\", \"Merchant\", \"Category\", \"Amount\"]];\n\n    expensesTable.rows.add(null /*add at the end*/, [\n      [\"1/1/2017\", \"The Phone Company\", \"Communications\", \"$120\"],\n      [\"1/2/2017\", \"Northwind Electric Cars\", \"Transportation\", \"$142\"],\n      [\"1/5/2017\", \"Best For You Organics Company\", \"Groceries\", \"$27\"]\n    ]);\n\n    sheet.getUsedRange().format.autofitColumns();\n    sheet.getUsedRange().format.autofitRows();\n\n    sheet.activate();\n    await context.sync();\n  });\n}"
    }
  ]
}