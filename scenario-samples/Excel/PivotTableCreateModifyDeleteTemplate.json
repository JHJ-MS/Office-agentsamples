{
    "Templates": [
        {
            "Description": "Creates, modify and delete a pivotTable. Modify pivotTable includes: add a row to PivotTable, remove a row from PivotTable, add data hierarchies to a pivotTable.",
            "SampleCodes": "async function createPivotTable() {\n  await Excel.run(async (context) => {\n    const rangeToAnalyze = context.workbook.worksheets.getItem(\"Data\").getRange(\"A1:E21\");\n    const rangeToPlacePivot = context.workbook.worksheets.getItem(\"Pivot\").getRange(\"A2\");\n    context.workbook.worksheets.getItem(\"Pivot\").pivotTables.add(\"Farm Sales\", rangeToAnalyze, rangeToPlacePivot);\n\n    await context.sync();\n  });\n}\n\nasync function addRowToPivotTable() {\n  await Excel.run(async (context) => {\n    const pivotTable = context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem(\"Farm Sales\");\n\n    // Check if the PivotTable already has rows.\n    const farmRow = pivotTable.rowHierarchies.getItemOrNullObject(\"Farm\");\n    pivotTable.rowHierarchies.load();\n    await context.sync();\n\n    if (farmRow.isNullObject) {\n    // Add the row \"Farm\" to pivotTable\n      pivotTable.rowHierarchies.add(pivotTable.hierarchies.getItem(\"Farm\"));\n    }\n\n    await context.sync();\n  });\n}\n\nasync function addDataHierarchiesToPivotTable() {\n  await Excel.run(async (context) => {\n    const pivotTable = context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem(\"Farm Sales\");\n    pivotTable.dataHierarchies.add(pivotTable.hierarchies.getItem(\"Crates Sold at Farm\"));\n    pivotTable.dataHierarchies.add(pivotTable.hierarchies.getItem(\"Crates Sold Wholesale\"));\n\n    await context.sync();\n  });\n}\n\nasync function removeRowFromPivotTable() {\n  await Excel.run(async (context) => {\n    const pivotTable = context.workbook.worksheets.getActiveWorksheet().pivotTables.getItem(\"Farm Sales\");\n\n    // Check if the PivotTable already has rows.\n    const farmRow = pivotTable.rowHierarchies.getItemOrNullObject(\"Farm\");\n    pivotTable.rowHierarchies.load();\n    await context.sync();\n\n   if (!farmRow.isNullObject) {\n    // remove the row \"farmRow\" from pivotTable\n      pivotTable.rowHierarchies.remove(farmRow);\n    }\n    await context.sync();\n  });\n}\n\nasync function deletePivotTable() {\n  await Excel.run(async (context) => {\n    context.workbook.worksheets\n      .getItem(\"Pivot\")\n      .pivotTables.getItem(\"Farm Sales\")\n      .delete();\n\n    await context.sync();\n  });\n}"
        }
    ]
}