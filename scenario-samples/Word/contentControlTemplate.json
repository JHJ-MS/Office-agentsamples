{
  "Templates": [
    {
      "Description": "Get all the comments in the document, selection, insert a new comment, delete a comment, and reply to a comment.",
      "SampleCodes": "\r\nasync function insertContentControls() {\r\n  \/\/ Traverses each paragraph of the document and wraps a content control on each with either a even or odd tags.\r\n  await Word.run(async (context) => {\r\n    let paragraphs = context.document.body.paragraphs;\r\n    paragraphs.load(\"$none\"); \/\/ Don't need any properties; just wrap each paragraph with a content control.\r\n\r\n    await context.sync();\r\n\r\n    for (let i = 0; i < paragraphs.items.length; i++) {\r\n      let contentControl = paragraphs.items[i].insertContentControl(); \/\/ insert content control on the paragraph\r\n      \/\/ For even, tag \"even\".\r\n      if (i % 2 === 0) {\r\n        contentControl.tag = \"even\";\r\n      } else {\r\n        contentControl.tag = \"odd\";\r\n      }\r\n    }\r\n    console.log(\"Content controls inserted: \" + paragraphs.items.length);\r\n\r\n    await context.sync();\r\n  });\r\n}\r\n\r\nasync function modifyContentControls() {\r\n  \/\/ Adds title and colors to odd and even content controls and changes their appearance.\r\n  await Word.run(async (context) => {\r\n    \/\/ Get the complete sentence (as range) associated with the insertion point.\r\n    let evenContentControls = context.document.contentControls.getByTag(\"even\");\r\n    let oddContentControls = context.document.contentControls.getByTag(\"odd\");\r\n    evenContentControls.load(\"length\");\r\n    oddContentControls.load(\"length\");\r\n\r\n    await context.sync();\r\n\r\n    for (let i = 0; i < evenContentControls.items.length; i++) {\r\n      \/\/ Change a few properties and append a paragraph\r\n      evenContentControls.items[i].set({\r\n        color: \"red\",\r\n        title: \"Odd ContentControl #\" + (i + 1),\r\n        appearance: Word.ContentControlAppearance.tags\r\n      });\r\n      evenContentControls.items[i].insertParagraph(\"This is an odd content control\", \"End\");\r\n    }\r\n\r\n    for (let j = 0; j < oddContentControls.items.length; j++) {\r\n      \/\/ Change a few properties and append a paragraph\r\n      oddContentControls.items[j].set({\r\n        color: \"green\",\r\n        title: \"Even ContentControl #\" + (j + 1),\r\n        appearance: \"Tags\"\r\n      });\r\n      oddContentControls.items[j].insertHtml(\"This is an <b>even<\/b> content control\", \"End\");\r\n    }\r\n\r\n    await context.sync();\r\n  });\r\n}\r\n\r\nlet eventContext;\r\nasync function registerOnContentControlAddedHandler() {\r\n  \/\/ Registers the onContentControlAdded event handler on the document.\r\n  await Word.run(async (context) => {\r\n    eventContext = context.document.onContentControlAdded.add(contentControlAdded);\r\n    await context.sync();\r\n\r\n    console.log(\"Added event handler for when content controls are added.\");\r\n  });\r\n}\r\n\r\nasync function contentControlAdded(event: Word.ContentControlAddedEventArgs) {\r\n  await Word.run(async (context) => {\r\n    console.log(`${event.eventType} event detected. IDs of content controls that were added:`);\r\n    console.log(event.ids);\r\n  });\r\n}\r\n\r\nasync function registerOnDataEventHandlers() {\r\n  await Word.run(async (context) => {\r\n    const contentControls = context.document.contentControls;\r\n    contentControls.load(\"items\");\r\n    await context.sync();\r\n\r\n    \/\/ Register the onDataChanged event handler on each content control.\r\n    if (contentControls.items.length === 0) {\r\n      console.log(\"There aren't any content controls in this document so can't register event handlers.\");\r\n    } else {\r\n      for (let i = 0; i < contentControls.items.length; i++) {\r\n        eventContexts[i] = contentControls.items[i].onDataChanged.add(contentControlDataChanged);\r\n        contentControls.items[i].track();\r\n      }\r\n\r\n      await context.sync();\r\n\r\n      console.log(\"Added event handlers for when data is changed in content controls.\");\r\n    }\r\n  });\r\n}\r\n\r\nasync function contentControlDataChanged(event: Word.ContentControlDataChangedEventArgs) {\r\n  await Word.run(async (context) => {\r\n    console.log(`${event.eventType} event detected. IDs of content controls where data was changed:`);\r\n    console.log(event.ids);\r\n  });\r\n}\r\n\r\n\r\nasync function setup() {\r\n  await Word.run(async (context) => {\r\n    const body = context.document.body;\r\n    body.clear();\r\n    body.insertParagraph(\"One more paragraph. \", \"Start\");\r\n    body.insertParagraph(\"Inserting another paragraph. \", \"Start\");\r\n    body.insertParagraph(\r\n      \"Video provides a powerful way to help you prove your point. When you click Online Video, you can paste in the embed code for the video you want to add. You can also type a keyword to search online for the video that best fits your document.\",\r\n      \"Start\"\r\n    );\r\n    body.paragraphs\r\n      .getLast()\r\n      .insertText(\r\n        \"To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. For example, you can add a matching cover page, header, and sidebar. Click Insert and then choose the elements you want from the different galleries. \",\r\n        \"Replace\"\r\n      );\r\n  });\r\n}\r\n\r\n\r\nlet eventContexts = [];\r\nasync function registerOnDeletedEventHandlers() {\r\n  await Word.run(async (context) => {\r\n    const contentControls = context.document.contentControls;\r\n    contentControls.load(\"items\");\r\n    await context.sync();\r\n\r\n    \/\/ Register the onDeleted event handler on each content control.\r\n    if (contentControls.items.length === 0) {\r\n      console.log(\"There aren't any content controls in this document so can't register event handlers.\");\r\n    } else {\r\n      for (let i = 0; i < contentControls.items.length; i++) {\r\n        eventContexts[i] = contentControls.items[i].onDeleted.add(contentControlDeleted);\r\n        contentControls.items[i].track();\r\n      }\r\n\r\n      await context.sync();\r\n\r\n      console.log(\"Added event handlers for when content controls are deleted.\");\r\n    }\r\n  });\r\n}\r\n\r\nasync function contentControlDeleted(event: Word.ContentControlDeletedEventArgs) {\r\n  await Word.run(async (context) => {\r\n    console.log(`${event.eventType} event detected. IDs of content controls that were deleted:`);\r\n    console.log(event.ids);\r\n  });\r\n}"
    }
  ]
}